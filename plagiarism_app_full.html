<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç Pro - Material You</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root {
            --md-primary: #6750A4;
            --md-primary-container: #EADDFF;
            --md-secondary: #625B71;
            --md-secondary-container: #E8DEF8;
            --md-tertiary: #7D5260;
            --md-surface: #FFFBFE;
            --md-surface-variant: #E7E0EC;
            --md-background: #FFFBFE;
            --md-error: #BA1A1A;
            --md-success: #2E7D32;
            --md-warning: #F57C00;
            --md-on-primary: #FFFFFF;
            --md-on-surface: #1C1B1F;
            --md-outline: #79747E;
            --md-shadow: rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* LOGIN PAGE */
        .login-page {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background: var(--md-surface);
            border-radius: 28px;
            padding: 48px;
            max-width: 480px;
            width: 100%;
            box-shadow: 0 8px 32px var(--md-shadow);
            animation: fadeInUp 0.6s ease-out;
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-icon {
            font-size: 64px;
            animation: float 3s ease-in-out infinite;
            margin-bottom: 16px;
        }

        .login-title {
            font-size: 32px;
            font-weight: 700;
            color: var(--md-on-surface);
            margin-bottom: 8px;
        }

        .login-subtitle {
            font-size: 16px;
            color: var(--md-outline);
        }

        .md-button {
            background: var(--md-primary);
            color: var(--md-on-primary);
            border: none;
            border-radius: 100px;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            width: 100%;
            box-shadow: 0 2px 8px rgba(103, 80, 164, 0.3);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .md-button:hover {
            box-shadow: 0 4px 16px rgba(103, 80, 164, 0.4);
            transform: translateY(-2px);
        }

        .md-button:active {
            transform: translateY(0);
        }

        .md-button-secondary {
            background: var(--md-secondary);
        }

        .md-button-outline {
            background: transparent;
            border: 2px solid var(--md-primary);
            color: var(--md-primary);
        }

        .md-select {
            width: 100%;
            padding: 16px;
            border: 2px solid var(--md-outline);
            border-radius: 12px;
            font-size: 16px;
            color: var(--md-on-surface);
            background: var(--md-surface);
            margin-bottom: 24px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .md-select:focus {
            outline: none;
            border-color: var(--md-primary);
            box-shadow: 0 0 0 4px rgba(103, 80, 164, 0.1);
        }

        /* MAIN PAGE */
        .main-page {
            display: none;
            animation: fadeInUp 0.6s ease-out;
        }

        .main-page.active {
            display: block;
        }

        /* NAVBAR */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 16px 24px;
            margin: 20px;
            box-shadow: 0 8px 32px var(--md-shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 24px;
            font-weight: 700;
            color: var(--md-primary);
        }

        .nav-user {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-chip {
            background: var(--md-primary-container);
            color: var(--md-primary);
            padding: 8px 16px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .logout-btn {
            background: transparent;
            border: 2px solid var(--md-error);
            color: var(--md-error);
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .logout-btn:hover {
            background: var(--md-error);
            color: white;
        }

        /* LAYOUT */
        .content {
            margin: 20px;
        }

        .layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 20px;
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 24px;
            box-shadow: 0 8px 32px var(--md-shadow);
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 8px;
            color: var(--md-on-surface);
            font-weight: 500;
        }

        .menu-item:hover {
            background: var(--md-secondary-container);
            transform: translateX(4px);
        }

        .menu-item.active {
            background: var(--md-primary-container);
            color: var(--md-primary);
        }

        /* CARD */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 8px 32px var(--md-shadow);
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px var(--md-shadow);
        }

        .card-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--md-on-surface);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* METRICS */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .metric-card {
            background: linear-gradient(135deg, var(--md-primary) 0%, var(--md-secondary) 100%);
            border-radius: 20px;
            padding: 24px;
            color: white;
            box-shadow: 0 8px 24px rgba(103, 80, 164, 0.3);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            transition: all 0.6s;
        }

        .metric-card:hover {
            transform: translateY(-4px) scale(1.02);
            animation: pulse 2s infinite;
        }

        .metric-card:hover::before {
            top: -100%;
            right: -100%;
        }

        .metric-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 4px;
            position: relative;
            z-index: 1;
        }

        .metric-label {
            font-size: 14px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        /* INPUT */
        .md-input {
            width: 100%;
            padding: 16px;
            border: 2px solid var(--md-outline);
            border-radius: 12px;
            font-size: 16px;
            font-family: 'Roboto', sans-serif;
            transition: all 0.3s;
            background: var(--md-surface);
            margin-bottom: 16px;
        }

        .md-input:focus {
            outline: none;
            border-color: var(--md-primary);
            box-shadow: 0 0 0 4px rgba(103, 80, 164, 0.1);
        }

        .md-textarea {
            min-height: 150px;
            resize: vertical;
        }

        /* RESULT CARD */
        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 32px;
            color: white;
            margin-top: 24px;
            animation: fadeInUp 0.6s ease-out;
        }

        .similarity-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 48px;
            font-weight: 700;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            position: relative;
        }

        .similarity-circle::after {
            content: '';
            position: absolute;
            inset: -10px;
            border-radius: 50%;
            padding: 10px;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeInUp 0.6s ease-out;
        }

        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-admin {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .badge-user {
            background: var(--md-secondary-container);
            color: var(--md-secondary);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--md-surface-variant);
            border-radius: 4px;
            overflow: hidden;
            margin: 16px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--md-primary), var(--md-secondary));
            border-radius: 4px;
            transition: width 0.6s ease-out;
        }

        .info-box {
            margin-top: 24px;
            padding: 16px;
            background: var(--md-primary-container);
            border-radius: 12px;
            font-size: 14px;
            border-left: 4px solid var(--md-primary);
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 14px;
        }

        .status-success {
            background: #E8F5E9;
            color: var(--md-success);
        }

        .status-warning {
            background: #FFF3E0;
            color: var(--md-warning);
        }

        .status-error {
            background: #FFEBEE;
            color: var(--md-error);
        }

        .doc-item {
            background: var(--md-surface-variant);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 12px;
            transition: all 0.3s;
            border-left: 4px solid var(--md-primary);
        }

        .doc-item:hover {
            transform: translateX(8px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .doc-title {
            font-weight: 600;
            font-size: 18px;
            color: var(--md-on-surface);
            margin-bottom: 8px;
        }

        .doc-meta {
            font-size: 14px;
            color: var(--md-outline);
            margin-bottom: 12px;
        }

        .doc-text {
            font-size: 15px;
            line-height: 1.6;
            color: var(--md-on-surface);
        }

        .filter-section {
            background: var(--md-surface-variant);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }

        .stat-item {
            background: var(--md-surface-variant);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--md-primary);
        }

        .stat-label {
            font-size: 14px;
            color: var(--md-outline);
            margin-top: 4px;
        }

        .code-block {
            background: #1E1E1E;
            color: #D4D4D4;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 16px 0;
        }

        .tab-container {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--md-outline);
        }

        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: var(--md-outline);
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab:hover {
            color: var(--md-primary);
        }

        .tab.active {
            color: var(--md-primary);
            border-bottom-color: var(--md-primary);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 968px) {
            .layout {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
                display: flex;
                overflow-x: auto;
                padding: 16px;
            }
            
            .menu-item {
                flex-shrink: 0;
            }

            .navbar {
                flex-direction: column;
                gap: 16px;
            }
        }

        .chart-container {
            background: var(--md-surface);
            padding: 20px;
            border-radius: 16px;
            margin-top: 20px;
        }

        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .tooltip.show {
            opacity: 1;
        }
    </style>
</head>
<body>

    <!-- LOGIN PAGE -->
    <div class="login-page" id="loginPage">
        <div class="login-card">
            <div class="login-header">
                <div class="login-icon">üîç</div>
                <h1 class="login-title">–ê–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç Pro</h1>
                <p class="login-subtitle">–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤</p>
            </div>

            <select class="md-select" id="userSelect">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</option>
            </select>

            <button class="md-button" onclick="login()">
                <span class="material-icons">login</span>
                –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
            </button>

            <div class="info-box">
                <p style="margin-bottom: 8px;"><strong>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong></p>
                <p>üëë <strong>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</strong> - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø</p>
                <p>üë§ <strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</strong> - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤</p>
            </div>
        </div>
    </div>

    <!-- MAIN PAGE -->
    <div class="main-page" id="mainPage">
        <nav class="navbar">
            <div class="nav-brand">
                <span class="material-icons">search</span>
                <span>–ê–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç Pro</span>
            </div>
            <div class="nav-user">
                <div class="user-chip">
                    <span class="material-icons">account_circle</span>
                    <span id="userName"></span>
                    <span class="badge" id="userRole"></span>
                </div>
                <button class="logout-btn" onclick="logout()">
                    <span class="material-icons">logout</span>
                    –í—ã–π—Ç–∏
                </button>
            </div>
        </nav>

        <div class="content">
            <div class="layout">
                <aside class="sidebar">
                    <div class="menu-item active" onclick="showSection('overview')">
                        <span class="material-icons">dashboard</span>
                        <span>–û–±–∑–æ—Ä</span>
                    </div>
                    <div class="menu-item" onclick="showSection('check')">
                        <span class="material-icons">spellcheck</span>
                        <span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</span>
                    </div>
                    <div class="menu-item" onclick="showSection('data')">
                        <span class="material-icons">folder</span>
                        <span>–î–∞–Ω–Ω—ã–µ</span>
                    </div>
                    <div class="menu-item" onclick="showSection('functions')">
                        <span class="material-icons">functions</span>
                        <span>–§—É–Ω–∫—Ü–∏–∏</span>
                    </div>
                    <div class="menu-item" onclick="showSection('pipelines')">
                        <span class="material-icons">account_tree</span>
                        <span>–ü–∞–π–ø–ª–∞–π–Ω—ã</span>
                    </div>
                    <div class="menu-item" onclick="showSection('memo')">
                        <span class="material-icons">memory</span>
                        <span>–ú–µ–º–æ–∏–∑–∞—Ü–∏—è</span>
                    </div>
                    <div class="menu-item" onclick="showSection('reports')">
                        <span class="material-icons">assessment</span>
                        <span>–û—Ç—á—ë—Ç—ã</span>
                    </div>
                    <div class="menu-item" onclick="showSection('tests')">
                        <span class="material-icons">fact_check</span>
                        <span>–¢–µ—Å—Ç—ã</span>
                    </div>
                    <div class="menu-item" onclick="showSection('about')">
                        <span class="material-icons">info</span>
                        <span>–û –ø—Ä–æ–µ–∫—Ç–µ</span>
                    </div>
                </aside>

                <main>
                    <!-- OVERVIEW -->
                    <section id="overview" class="section active">
                        <div class="card">
                            <h2 class="card-title">
                                <span class="material-icons">dashboard</span>
                                –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã
                            </h2>
                        </div>
                        <div class="metrics-grid" id="metricsGrid"></div>
                        <div class="card">
                            <h3 class="card-title">
                                <span class="material-icons">trending_up</span>
                                –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                            </h3>
                            <div id="statisticsContent"></div>
                        </div>
                    </section>

                    <!-- CHECK -->
                    <section id="check" class="section">
                        <div class="card">
                            <h2 class="card-title">
                                <span class="material-icons">spellcheck</span>
                                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –ø–ª–∞–≥–∏–∞—Ç
                            </h2>
                            <textarea 
                                class="md-input md-textarea" 
                                id="checkText"
                                placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏..."></textarea>
                            
                            <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                                <label style="flex: 1;">
                                    <span style="display: block; margin-bottom: 8px; font-weight: 500;">–†–∞–∑–º–µ—Ä n-–≥—Ä–∞–º–º:</span>
                                    <input type="number" class="md-input" id="ngramSize" value="3" min="1" max="5" style="margin: 0;">
                                </label>
                                <label style="flex: 1;">
                                    <span style="display: block; margin-bottom: 8px; font-weight: 500;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à:</span>
                                    <select class="md-select" id="useCache" style="margin: 0;">
                                        <option value="true">–î–∞ (–±—ã—Å—Ç—Ä–µ–µ)</option>
                                        <option value="false">–ù–µ—Ç</option>
                                    </select>
                                </label>
                            </div>
                            
                            <button class="md-button" onclick="checkPlagiarism()">
                                <span class="material-icons">search</span>
                                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –ø–ª–∞–≥–∏–∞—Ç
                            </button>
                            <div id="checkResult"></div>
                        </div>
                    </section>

                    <!-- DATA -->
                    <section id="data" class="section">
                        <div class="card">
                            <h2 class="card-title">
                                <span class="material-icons">folder</span>
                                –ë–∞–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
                            </h2>
                            
                            <div class="filter-section">
                                <h3 style="margin-bottom: 12px;">üîç –§–∏–ª—å—Ç—Ä—ã (–õ–∞–±–∞ ‚Ññ2)</h3>
                                <div class="filter-row">
                                    <input type="text" class="md-input" id="filterAuthor" placeholder="–ê–≤—Ç–æ—Ä..." style="margin: 0;">
                                    <input type="text" class="md-input" id="filterTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ..." style="margin: 0;">
                                    <input type="number" class="md-input" id="filterMinLength" placeholder="–ú–∏–Ω. –¥–ª–∏–Ω–∞..." style="margin: 0;">
                                </div>
                                <button class="md-button" onclick="applyFilters()" style="margin-top: 16px;">
                                    <span class="material-icons">filter_alt</span>
                                    –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                                </button>
                            </div>
                            
                            <div id="documentsTable"></div>
                        </div>
                    </section>

                    <!-- FUNCTIONS -->
                    <section id="functions" class="section">
                        <div class="card">
                            <h2 class="card-title">
                                <span class="material-icons">functions</span>
                                –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π (–õ–∞–±–∞ ‚Ññ1)
                            </h2>
                            <p style="margin-bottom: 20px; color: var(--md-outline);">
                                –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞: normalize, tokenize, ngrams, jaccard
                            </p>
                            <textarea 
                                class="md-input md-textarea" 
                                id="demoText"
                                placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç...">–ü—Ä–∏–≤–µ—Ç, –ú–∏—Ä! –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π.</textarea>
                            <button class="md-button" onclick="demonstrateFunctions()">
                                <span class="material-icons">play_arrow</span>
                                –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é
                            </button>
                            <div id="functionResults"></div>
                        </div>
                    </section>

                    <!-- PIPELINES -->
                    <section id="pipelines" class="section">
                        <div class="card">
                            <h2 class="card-title">
                                <span class="material-icons">account_tree</span>
                                –ü–∞–π–ø–ª–∞–π–Ω—ã –∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏—è (–õ–∞–±–∞ ‚Ññ4)
                            </h2>
                            
                            <div class="tab-container">
                                <button class="tab active" onclick="showPipelineTab('compose')">–ö–æ–º–ø–æ–∑–∏—Ü–∏—è</button>
                                <button class="tab" onclick="showPipelineTab('maybe')">Maybe/Either</button>
                                <button class="tab" onclick="showPipelineTab('validation')">–í–∞–ª–∏–¥–∞—Ü–∏—è</button>
                            </div>

                            <div id="pipelineCompose" class="pipeline-tab active">
                                <h3>–ö–æ–º–ø–æ–∑–∏—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π</h3>
                                <textarea class="md-input md-textarea" id="pipelineText" placeholder="–¢–µ–∫—Å—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏...">–ü—Ä–∏–≤–µ—Ç, –ú–ò–†!!! –≠—Ç–æ –¢–ï–°–¢ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π.</textarea>
                                <button class="md-button" onclick="demonstrateComposition()">
                                    <span class="material-icons">layers</span>
                                    –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø–∞–π–ø–ª–∞–π–Ω
                                </button>
                                <div id="compositionResult"></div>
                            </div>

                            <div id="pipelineMaybe" class="pipeline-tab" style="display: none;">
                                <h3>Maybe/Either —Ç–∏–ø—ã</h3>
                                <p style="color: var(--md-outline); margin-bottom: 16px;">
                                    –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
                                </p>
                                <input type="text" class="md-input" id="docId" placeholder="ID –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: doc_001)">
                                <button class="md-button" onclick="demonstrateMaybe()">
                                    <span class="material-icons">done</span>
                                    –ù–∞–π—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç (Maybe)
                                </button>
                                <div id="maybeResult"></div>
                            </div>

                            <div id="pipelineValidation" class="pipeline-tab" style="display: none;">
                                <h3>–í–∞–ª–∏–¥–∞—Ü–∏—è —Å Either</h3>
                                <textarea class="md-input md-textarea" id="validationText" placeholder="–¢–µ–∫—Å—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏..."></textarea>
                                <input type="number" class="md-input" id="minLengthValidation" placeholder="–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞" value="50">
                                <button class="md-button" onclick="demonstrateValidation()">
                                    <span class="material-icons">verified</span>
                                    –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                                <div id="validationResult"></div>
                            </div>
                        </div>
                    </section>

                    <!-- MEMOIZATION -->
                    <section id="memo" class="section">
                        <div class="card">
                            <h2 class="card-title">
                                <span class="material-icons">memory</span>
                                –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–õ–∞–±–∞ ‚Ññ3)
                            </h2>
                            <p style="color: var(--md-outline); margin-bottom: 20px;">
                                –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –∫—ç—à–µ–º –∏ –±–µ–∑ –∫—ç—à–∞
                            </p>
                            
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-value" id="cacheHits">0</div>
                                    <div class="stat-label">–ü–æ–ø–∞–¥–∞–Ω–∏—è –≤ –∫—ç—à</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="cacheMisses">0</div>
                                    <div class="stat-label">–ü—Ä–æ–º–∞—Ö–∏ –∫—ç—à–∞</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="cacheSize">0</div>
                                    <div class="stat-label">–†–∞–∑–º–µ—Ä –∫—ç—à–∞</div>
                                </div>
                            </div>

                            <button class="md-button" onclick="runBenchmark()" style="margin-top: 20px;">
                                <span class="material-icons">speed</span>
                                –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–Ω—á–º–∞—Ä–∫
                            </button>
                            
                            <div id="benchmarkResult"></div>
                        </div>
                    </section>

                    <!-- REPORTS -->
                    <section id="reports" class="section">
                        <div class="card">
                            <h2 class="card-title">
                                <span class="material-icons">assessment</span>
                                –û—Ç—á—ë—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
                            </h2>
                            
                            <div class="tab-container">
                                <button class="tab active" onclick="showReportTab('summary')">–°–≤–æ–¥–∫–∞</button>
                                <button class="tab" onclick="showReportTab('top')">–¢–æ–ø –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö</button>
                                <button class="tab" onclick="showReportTab('users')">–ü–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</button>
                            </div>

                            <div id="reportSummary" class="report-tab active">
                                <div id="summaryContent"></div>
                            </div>

                            <div id="reportTop" class="report-tab" style="display: none;">
                                <div id="topContent"></div>
                            </div>

                            <div id="reportUsers" class="report-tab" style="display: none;">
                                <div id="usersContent"></div>
                            </div>

                            <button class="md-button" onclick="generateReport()">
                                <span class="material-icons">description</span>
                                –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç
                            </button>
                        </div>
                    </section>

                    <!-- TESTS -->
                    <section id="tests" class="section">
                        <div class="card">
                            <h2 class="card-title">
                                <span class="material-icons">fact_check</span>
                                –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
                            </h2>
                            <p style="color: var(--md-outline); margin-bottom: 20px;">
                                –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
                            </p>
                            
                            <button class="md-button" onclick="runAllTests()">
                                <span class="material-icons">play_circle</span>
                                –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
                            </button>
                            
                            <div id="testResults"></div>
                        </div>
                    </section>

                    <!-- ABOUT -->
                    <section id="about" class="section">
                        <div class="card">
                            <h2 class="card-title">
                                <span class="material-icons">info</span>
                                –û –ø—Ä–æ–µ–∫—Ç–µ
                            </h2>
                            <p style="font-size: 16px; line-height: 1.6; margin-bottom: 16px;">
                                <strong>–ê–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç Pro</strong> - —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å—Ç–∏–ª–µ.
                            </p>
                            
                            <h3 style="margin: 24px 0 12px;">üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</h3>
                            <div style="display: grid; gap: 12px;">
                                <div class="info-box">
                                    <strong>‚úÖ –õ–∞–±–∞ ‚Ññ1:</strong> –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ + –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å + HOF (map/filter/reduce)
                                </div>
                                <div class="info-box">
                                    <strong>‚úÖ –õ–∞–±–∞ ‚Ññ2:</strong> –õ—è–º–±–¥–∞ –∏ –∑–∞–º—ã–∫–∞–Ω–∏—è + —Ä–µ–∫—É—Ä—Å–∏—è
                                </div>
                                <div class="info-box">
                                    <strong>‚úÖ –õ–∞–±–∞ ‚Ññ3:</strong> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ä–µ–∫—É—Ä—Å–∏—è + –º–µ–º–æ–∏–∑–∞—Ü–∏—è
                                </div>
                                <div class="info-box">
                                    <strong>‚úÖ –õ–∞–±–∞ ‚Ññ4:</strong> Maybe/Either —Ç–∏–ø—ã + –∫–æ–º–ø–æ–∑–∏—Ü–∏—è
                                </div>
                            </div>

                            <h3 style="margin: 24px 0 12px;">üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:</h3>
                            <ul style="list-style: none; padding: 0;">
                                <li style="padding: 8px 0;">üì¶ Python 3.11+</li>
                                <li style="padding: 8px 0;">üé® Material You Design</li>
                                <li style="padding: 8px 0;">‚ö° –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
                                <li style="padding: 8px 0;">üß™ Pytest –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
                                <li style="padding: 8px 0;">üíæ JSON –¥–ª—è –¥–∞–Ω–Ω—ã—Ö</li>
                            </ul>

                            <h3 style="margin: 24px 0 12px;">üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:</h3>
                            <div class="code-block">
core/
  domain.py      # –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏
  transforms.py  # –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  closures.py    # –ó–∞–º—ã–∫–∞–Ω–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä—ã
  memo.py        # –ú–µ–º–æ–∏–∑–∞—Ü–∏—è
  ftypes.py      # Maybe/Either
  compose.py     # –ö–æ–º–ø–æ–∑–∏—Ü–∏—è
                            </div>
                        </div>
                    </section>
                </main>
            </div>
        </div>
    </div>

    <script>
        let appData = {
            documents: [],
            users: [],
            submissions: [],
            rules: []
        };

        let currentUser = null;
        let cache = new Map();
        let cacheStats = { hits: 0, misses: 0 };

        // ============ –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• ============
        async function loadData() {
            try {
                const response = await fetch('data/seed.json');
                const data = await response.json();
                
                appData.documents = data.documents || [];
                appData.users = (data.users || []).map((u, i) => ({
                    ...u,
                    role: u.role || (i < 3 ? 'admin' : 'user')
                }));
                appData.submissions = data.submissions || [];
                appData.rules = data.rules || [];
                
                populateUserSelect();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª data/seed.json');
            }
        }

        function populateUserSelect() {
            const select = document.getElementById('userSelect');
            appData.users.forEach(user => {
                const option = document.createElement('option');
                option.value = user.id;
                option.textContent = `${user.name} (${user.role === 'admin' ? 'üëë –ê–¥–º–∏–Ω' : 'üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'})`;
                select.appendChild(option);
            });
        }

        // ============ AUTHENTICATION ============
        function login() {
            const select = document.getElementById('userSelect');
            const userId = select.value;
            
            if (!userId) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                return;
            }
            
            currentUser = appData.users.find(u => u.id === userId);
            
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainPage').classList.add('active');
            
            document.getElementById('userName').textContent = currentUser.name;
            const roleBadge = document.getElementById('userRole');
            roleBadge.textContent = currentUser.role === 'admin' ? 'üëë –ê–¥–º–∏–Ω' : 'üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            roleBadge.className = `badge ${currentUser.role === 'admin' ? 'badge-admin' : 'badge-user'}`;
            
            renderOverview();
        }

        function logout() {
            currentUser = null;
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('mainPage').classList.remove('active');
            document.getElementById('userSelect').value = '';
        }

        // ============ NAVIGATION ============
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
            event.target.closest('.menu-item').classList.add('active');
            
            if (sectionId === 'overview') renderOverview();
            if (sectionId === 'data') renderData();
            if (sectionId === 'reports') generateReport();
        }

        function showPipelineTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.pipeline-tab').forEach(t => t.style.display = 'none');
            document.getElementById('pipeline' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.display = 'block';
        }

        function showReportTab(tabName) {
            document.querySelectorAll('#reports .tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.report-tab').forEach(t => t.style.display = 'none');
            document.getElementById('report' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.display = 'block';
        }

        // ============ CORE FUNCTIONS (–õ–ê–ë–ê ‚Ññ1) ============
        function normalize(text) {
            return text.toLowerCase().replace(/[^\w–∞-—è—ë\s]/gi, '').replace(/\s+/g, ' ').trim();
        }
        
        function tokenize(text) {
            return text.split(' ').filter(w => w.length > 0);
        }
        
        function ngrams(tokens, n = 3) {
            const result = [];
            for (let i = 0; i <= tokens.length - n; i++) {
                result.push(tokens.slice(i, i + n).join(' '));
            }
            return result;
        }
        
        function jaccard(set1, set2) {
            const s1 = new Set(set1);
            const s2 = new Set(set2);
            const intersection = new Set([...s1].filter(x => s2.has(x)));
            const union = new Set([...s1, ...s2]);
            return union.size > 0 ? intersection.size / union.size : 0;
        }

        // ============ CLOSURES (–õ–ê–ë–ê ‚Ññ2) ============
        function byAuthor(author) {
            return (doc) => doc.author.toLowerCase().includes(author.toLowerCase());
        }

        function byTitle(keyword) {
            return (doc) => doc.title.toLowerCase().includes(keyword.toLowerCase());
        }

        function byMinLength(minLen) {
            return (doc) => doc.text.length >= minLen;
        }

        function composeFilters(...filters) {
            return (item) => filters.every(f => f(item));
        }

        // ============ MEMOIZATION (–õ–ê–ë–ê ‚Ññ3) ============
        function getCacheKey(text1, text2, n) {
            return `${text1.substring(0, 50)}_${text2.substring(0, 50)}_${n}`;
        }

        function compareTextsCached(text1, text2, n = 3) {
            const key = getCacheKey(text1, text2, n);
            
            if (cache.has(key)) {
                cacheStats.hits++;
                updateCacheStats();
                return cache.get(key);
            }
            
            cacheStats.misses++;
            const normalized1 = normalize(text1);
            const normalized2 = normalize(text2);
            const tokens1 = tokenize(normalized1);
            const tokens2 = tokenize(normalized2);
            const ngrams1 = ngrams(tokens1, n);
            const ngrams2 = ngrams(tokens2, n);
            const similarity = jaccard(ngrams1, ngrams2);
            
            cache.set(key, similarity);
            updateCacheStats();
            return similarity;
        }

        function updateCacheStats() {
            document.getElementById('cacheHits').textContent = cacheStats.hits;
            document.getElementById('cacheMisses').textContent = cacheStats.misses;
            document.getElementById('cacheSize').textContent = cache.size;
        }

        // ============ MAYBE/EITHER (–õ–ê–ë–ê ‚Ññ4) ============
        class Maybe {
            constructor(value, isNothing = false) {
                this._value = value;
                this._isNothing = isNothing;
            }
            
            static just(value) {
                return new Maybe(value, false);
            }
            
            static nothing() {
                return new Maybe(null, true);
            }
            
            isNothing() {
                return this._isNothing;
            }
            
            isJust() {
                return !this._isNothing;
            }
            
            get(defaultValue = null) {
                return this._isNothing ? defaultValue : this._value;
            }
            
            map(fn) {
                if (this._isNothing) return Maybe.nothing();
                try {
                    return Maybe.just(fn(this._value));
                } catch {
                    return Maybe.nothing();
                }
            }
        }

        class Either {
            constructor(value, isLeft) {
                this._value = value;
                this._isLeft = isLeft;
            }
            
            static left(error) {
                return new Either(error, true);
            }
            
            static right(value) {
                return new Either(value, false);
            }
            
            isLeft() {
                return this._isLeft;
            }
            
            isRight() {
                return !this._isLeft;
            }
            
            getRight(defaultValue = null) {
                return this._isLeft ? defaultValue : this._value;
            }
            
            getLeft(defaultValue = null) {
                return this._isLeft ? this._value : defaultValue;
            }
            
            map(fn) {
                if (this._isLeft) return Either.left(this._value);
                try {
                    return Either.right(fn(this._value));
                } catch (e) {
                    return Either.left(e.message);
                }
            }
        }

        function safeGetDocument(docs, docId) {
            const doc = docs.find(d => d.id === docId);
            return doc ? Maybe.just(doc) : Maybe.nothing();
        }

        function validateSubmission(text, minLength = 50) {
            if (!text || text.trim().length === 0) {
                return Either.left("–¢–µ–∫—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º");
            }
            if (text.length < minLength) {
                return Either.left(`–¢–µ–∫—Å—Ç —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π (–º–∏–Ω–∏–º—É–º ${minLength} —Å–∏–º–≤–æ–ª–æ–≤)`);
            }
            return Either.right(text);
        }

        // ============ UI RENDERS ============
        function renderOverview() {
            const metricsHTML = `
                <div class="metric-card">
                    <div class="metric-value">${appData.documents.length}</div>
                    <div class="metric-label">–î–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${appData.users.length}</div>
                    <div class="metric-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${appData.submissions.length}</div>
                    <div class="metric-label">–ü—Ä–æ–≤–µ—Ä–æ–∫</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${appData.rules.length}</div>
                    <div class="metric-label">–ü—Ä–∞–≤–∏–ª</div>
                </div>
            `;
            document.getElementById('metricsGrid').innerHTML = metricsHTML;
            
            const avgDoc = appData.documents.length > 0
                ? Math.round(appData.documents.reduce((sum, d) => sum + d.text.length, 0) / appData.documents.length)
                : 0;
            
            const avgSub = appData.submissions.length > 0
                ? Math.round(appData.submissions.reduce((sum, s) => sum + s.text.length, 0) / appData.submissions.length)
                : 0;
            
            document.getElementById('statisticsContent').innerHTML = `
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">${avgDoc}</div>
                        <div class="stat-label">–°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${avgSub}</div>
                        <div class="stat-label">–°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${cache.size}</div>
                        <div class="stat-label">–ó–∞–ø–∏—Å–µ–π –≤ –∫—ç—à–µ</div>
                    </div>
                </div>
            `;
        }

        function renderData(filteredDocs = null) {
            const docs = filteredDocs || appData.documents;
            const docsHTML = docs.slice(0, 10).map(doc => `
                <div class="doc-item">
                    <div class="doc-title">${doc.title}</div>
                    <div class="doc-meta">
                        <span>üë§ ${doc.author}</span> ‚Ä¢ 
                        <span>üìÖ ${new Date(doc.ts).toLocaleDateString('ru-RU')}</span> ‚Ä¢ 
                        <span>üìù ${doc.text.length} —Å–∏–º–≤–æ–ª–æ–≤</span>
                    </div>
                    <div class="doc-text">${doc.text.substring(0, 150)}${doc.text.length > 150 ? '...' : ''}</div>
                </div>
            `).join('');
            
            document.getElementById('documentsTable').innerHTML = docsHTML + 
                `<p style="margin-top: 16px; color: var(--md-outline); text-align: center;">–ü–æ–∫–∞–∑–∞–Ω–æ ${Math.min(10, docs.length)} –∏–∑ ${docs.length} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</p>`;
        }

        function applyFilters() {
            const author = document.getElementById('filterAuthor').value;
            const title = document.getElementById('filterTitle').value;
            const minLength = parseInt(document.getElementById('filterMinLength').value) || 0;
            
            const filters = [];
            if (author) filters.push(byAuthor(author));
            if (title) filters.push(byTitle(title));
            if (minLength > 0) filters.push(byMinLength(minLength));
            
            const combinedFilter = composeFilters(...filters);
            const filtered = appData.documents.filter(combinedFilter);
            
            renderData(filtered);
        }

        // ============ PLAGIARISM CHECK ============
        function checkPlagiarism() {
            const text = document.getElementById('checkText').value;
            const n = parseInt(document.getElementById('ngramSize').value) || 3;
            const useCache = document.getElementById('useCache').value === 'true';
            
            if (!text || text.length < 10) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç (–º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤)');
                return;
            }
            
            const normalized = normalize(text);
            const tokens = tokenize(normalized);
            const textNgrams = ngrams(tokens, n);
            
            const results = appData.documents.map(doc => {
                const similarity = useCache 
                    ? compareTextsCached(text, doc.text, n)
                    : jaccard(textNgrams, ngrams(tokenize(normalize(doc.text)), n));
                return { doc, similarity };
            }).sort((a, b) => b.similarity - a.similarity);
            
            const best = results[0];
            const percentage = Math.round(best.similarity * 100);
            
            let statusClass, statusText, statusIcon;
            if (percentage < 30) {
                statusClass = 'status-success';
                statusText = '–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ';
                statusIcon = '‚úÖ';
            } else if (percentage < 70) {
                statusClass = 'status-warning';
                statusText = '–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ';
                statusIcon = '‚ö†Ô∏è';
            } else {
                statusClass = 'status-error';
                statusText = '–ü–ª–∞–≥–∏–∞—Ç';
                statusIcon = '‚ùå';
            }
            
            const top3HTML = results.slice(0, 3).map(r => `
                <div style="background: rgba(255,255,255,0.1); padding: 16px; border-radius: 12px; margin: 8px 0;">
                    <p style="font-weight: 600;">${r.doc.title}</p>
                    <p style="font-size: 14px; margin-bottom: 8px;">–ê–≤—Ç–æ—Ä: ${r.doc.author}</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${Math.round(r.similarity * 100)}%; background: white;"></div>
                    </div>
                    <p style="text-align: right; font-weight: 600; margin-top: 4px;">${Math.round(r.similarity * 100)}%</p>
                </div>
            `).join('');
            
            document.getElementById('checkResult').innerHTML = `
                <div class="result-card">
                    <div style="text-align: center; margin-bottom: 24px;">
                        <div class="status-indicator ${statusClass}" style="display: inline-flex; font-size: 18px;">
                            <span>${statusIcon}</span>
                            <span>${statusText}</span>
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <div class="similarity-circle">${percentage}%</div>
                        <p style="font-size: 18px; font-weight: 600;">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ—Ö–æ–∂–µ—Å—Ç—å</p>
                    </div>
                    
                    <h4 style="margin: 24px 0 12px;">üìä –¢–æ–ø-3 –ø–æ—Ö–æ–∂–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞:</h4>
                    ${top3HTML}
                    
                    <div style="margin-top: 24px; padding: 16px; background: rgba(255,255,255,0.1); border-radius: 12px;">
                        <p><strong>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:</strong></p>
                        <p>‚Ä¢ –¢–æ–∫–µ–Ω–æ–≤: ${tokens.length}</p>
                        <p>‚Ä¢ ${n}-–≥—Ä–∞–º–º: ${textNgrams.length}</p>
                        <p>‚Ä¢ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: ${appData.documents.length}</p>
                        <p>‚Ä¢ –ö—ç—à: ${useCache ? '–≤–∫–ª—é—á–µ–Ω ‚úÖ' : '–≤—ã–∫–ª—é—á–µ–Ω ‚ùå'}</p>
                    </div>
                </div>
            `;
        }

        // ============ FUNCTIONS DEMO ============
        function demonstrateFunctions() {
            const text = document.getElementById('demoText').value;
            
            if (!text) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏');
                return;
            }
            
            const normalized = normalize(text);
            const tokens = tokenize(normalized);
            const bigrams = ngrams(tokens, 2);
            const trigrams = ngrams(tokens, 3);
            
            // –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è map/filter/reduce
            const tokenLengths = tokens.map(t => t.length);
            const longTokens = tokens.filter(t => t.length > 3);
            const totalChars = tokenLengths.reduce((sum, len) => sum + len, 0);
            
            document.getElementById('functionResults').innerHTML = `
                <div class="card" style="margin-top: 24px;">
                    <h3 class="card-title">
                        <span class="material-icons">code</span>
                        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
                    </h3>
                    
                    <div class="info-box" style="background: #E3F2FD; border-left-color: #2196F3;">
                        <p style="font-weight: 600; margin-bottom: 8px;">1Ô∏è‚É£ normalize(text)</p>
                        <div class="code-block">"${normalized}"</div>
                    </div>
                    
                    <div class="info-box" style="background: #F3E5F5; border-left-color: #9C27B0;">
                        <p style="font-weight: 600; margin-bottom: 8px;">2Ô∏è‚É£ tokenize(text)</p>
                        <div class="code-block">[${tokens.map(t => `"${t}"`).join(', ')}]</div>
                        <p style="margin-top: 8px; color: var(--md-outline);">–í—Å–µ–≥–æ —Ç–æ–∫–µ–Ω–æ–≤: ${tokens.length}</p>
                    </div>
                    
                    <div class="info-box" style="background: #E8F5E9; border-left-color: #4CAF50;">
                        <p style="font-weight: 600; margin-bottom: 8px;">3Ô∏è‚É£ ngrams(tokens, 2) - –±–∏–≥—Ä–∞–º–º—ã</p>
                        <div class="code-block">${bigrams.slice(0, 5).map(g => `"${g}"`).join(', ')}...</div>
                        <p style="margin-top: 8px; color: var(--md-outline);">–í—Å–µ–≥–æ –±–∏–≥—Ä–∞–º–º: ${bigrams.length}</p>
                    </div>
                    
                    <div class="info-box" style="background: #FFF3E0; border-left-color: #FF9800;">
                        <p style="font-weight: 600; margin-bottom: 8px;">4Ô∏è‚É£ ngrams(tokens, 3) - —Ç—Ä–∏–≥—Ä–∞–º–º—ã</p>
                        <div class="code-block">${trigrams.slice(0, 5).map(g => `"${g}"`).join(', ')}...</div>
                        <p style="margin-top: 8px; color: var(--md-outline);">–í—Å–µ–≥–æ —Ç—Ä–∏–≥—Ä–∞–º–º: ${trigrams.length}</p>
                    </div>
                    
                    <div class="info-box">
                        <p style="font-weight: 600; margin-bottom: 12px;">üîß –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è HOF (map/filter/reduce):</p>
                        <p><strong>map:</strong> –¥–ª–∏–Ω—ã —Ç–æ–∫–µ–Ω–æ–≤ ‚Üí [${tokenLengths.join(', ')}]</p>
                        <p><strong>filter:</strong> —Ç–æ–∫–µ–Ω—ã >3 —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí [${longTokens.map(t => `"${t}"`).join(', ')}]</p>
                        <p><strong>reduce:</strong> —Å—É–º–º–∞ –¥–ª–∏–Ω ‚Üí ${totalChars}</p>
                    </div>
                    
                    <div style="background: var(--md-primary-container); padding: 16px; border-radius: 12px; margin-top: 16px;">
                        <p style="font-weight: 600; color: var(--md-primary); text-align: center;">
                            ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!
                        </p>
                    </div>
                </div>
            `;
        }

        // ============ COMPOSITION DEMO ============
        function demonstrateComposition() {
            const text = document.getElementById('pipelineText').value;
            
            if (!text) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏');
                return;
            }
            
            // –ü–∞–π–ø–ª–∞–π–Ω: normalize ‚Üí tokenize ‚Üí ngrams
            const step1 = normalize(text);
            const step2 = tokenize(step1);
            const step3 = ngrams(step2, 3);
            
            document.getElementById('compositionResult').innerHTML = `
                <div class="card" style="margin-top: 24px;">
                    <h3>–ü–∞–π–ø–ª–∞–π–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞</h3>
                    
                    <div style="display: flex; align-items: center; gap: 12px; margin: 20px 0;">
                        <div class="info-box" style="flex: 1; margin: 0;">
                            <strong>–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç</strong>
                            <p style="margin-top: 8px;">"${text}"</p>
                        </div>
                        <span class="material-icons" style="color: var(--md-primary);">arrow_forward</span>
                        <div class="info-box" style="flex: 1; margin: 0; background: #E3F2FD;">
                            <strong>normalize()</strong>
                            <p style="margin-top: 8px;">"${step1}"</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; align-items: center; gap: 12px; margin: 20px 0;">
                        <div class="info-box" style="flex: 1; margin: 0; background: #F3E5F5;">
                            <strong>tokenize()</strong>
                            <p style="margin-top: 8px;">[${step2.slice(0, 5).join(', ')}...]</p>
                            <p style="color: var(--md-outline); font-size: 12px; margin-top: 4px;">–í—Å–µ–≥–æ: ${step2.length}</p>
                        </div>
                        <span class="material-icons" style="color: var(--md-primary);">arrow_forward</span>
                        <div class="info-box" style="flex: 1; margin: 0; background: #E8F5E9;">
                            <strong>ngrams(3)</strong>
                            <p style="margin-top: 8px;">${step3.length} —Ç—Ä–∏–≥—Ä–∞–º–º</p>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <strong>‚úÖ –ö–æ–º–ø–æ–∑–∏—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∞</strong>
                        <p style="margin-top: 8px;">–§—É–Ω–∫—Ü–∏–∏ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â—É—é.</p>
                    </div>
                </div>
            `;
        }

        // ============ MAYBE DEMO ============
        function demonstrateMaybe() {
            const docId = document.getElementById('docId').value;
            
            if (!docId) {
                alert('–í–≤–µ–¥–∏—Ç–µ ID –¥–æ–∫—É–º–µ–Ω—Ç–∞');
                return;
            }
            
            const result = safeGetDocument(appData.documents, docId);
            
            if (result.isJust()) {
                const doc = result.get();
                document.getElementById('maybeResult').innerHTML = `
                    <div class="card" style="margin-top: 24px;">
                        <div class="info-box" style="background: #E8F5E9; border-left-color: var(--md-success);">
                            <h3>‚úÖ Maybe.just(document)</h3>
                            <p style="margin-top: 12px;"><strong>–î–æ–∫—É–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω:</strong></p>
                            <div class="doc-item" style="margin-top: 12px;">
                                <div class="doc-title">${doc.title}</div>
                                <div class="doc-meta">
                                    <span>ID: ${doc.id}</span> ‚Ä¢ 
                                    <span>–ê–≤—Ç–æ—Ä: ${doc.author}</span>
                                </div>
                                <div class="doc-text">${doc.text.substring(0, 200)}...</div>
                            </div>
                        </div>
                        
                        <div class="code-block" style="margin-top: 16px;">
const result = safeGetDocument(documents, "${docId}");
// result.isJust() === true
// result.get() === Document {...}
                        </div>
                    </div>
                `;
            } else {
                document.getElementById('maybeResult').innerHTML = `
                    <div class="card" style="margin-top: 24px;">
                        <div class="info-box" style="background: #FFF3E0; border-left-color: var(--md-warning);">
                            <h3>‚ö†Ô∏è Maybe.nothing()</h3>
                            <p style="margin-top: 12px;">–î–æ–∫—É–º–µ–Ω—Ç —Å ID "${docId}" –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ.</p>
                            <p style="margin-top: 8px; font-size: 14px; color: var(--md-outline);">
                                Maybe —Ç–∏–ø—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π.
                            </p>
                        </div>
                        
                        <div class="code-block" style="margin-top: 16px;">
const result = safeGetDocument(documents, "${docId}");
// result.isNothing() === true
// result.get(defaultValue) === defaultValue
                        </div>
                    </div>
                `;
            }
        }

        // ============ VALIDATION DEMO ============
        function demonstrateValidation() {
            const text = document.getElementById('validationText').value;
            const minLength = parseInt(document.getElementById('minLengthValidation').value) || 50;
            
            const result = validateSubmission(text, minLength);
            
            if (result.isRight()) {
                const validText = result.getRight();
                document.getElementById('validationResult').innerHTML = `
                    <div class="card" style="margin-top: 24px;">
                        <div class="info-box" style="background: #E8F5E9; border-left-color: var(--md-success);">
                            <h3>‚úÖ Either.right(text)</h3>
                            <p style="margin-top: 12px;"><strong>–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!</strong></p>
                            <p style="margin-top: 8px;">–î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞: ${validText.length} —Å–∏–º–≤–æ–ª–æ–≤ (–º–∏–Ω–∏–º—É–º: ${minLength})</p>
                            <p style="margin-top: 8px; padding: 12px; background: white; border-radius: 8px;">
                                ${validText.substring(0, 100)}${validText.length > 100 ? '...' : ''}
                            </p>
                        </div>
                        
                        <div class="code-block" style="margin-top: 16px;">
const result = validateSubmission(text, ${minLength});
// result.isRight() === true
// –¢–µ–∫—Å—Ç –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ –Ω–∞ –ø–ª–∞–≥–∏–∞—Ç
                        </div>
                    </div>
                `;
            } else {
                const error = result.getLeft();
                document.getElementById('validationResult').innerHTML = `
                    <div class="card" style="margin-top: 24px;">
                        <div class="info-box" style="background: #FFEBEE; border-left-color: var(--md-error);">
                            <h3>‚ùå Either.left(error)</h3>
                            <p style="margin-top: 12px;"><strong>–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:</strong></p>
                            <p style="margin-top: 8px; color: var(--md-error); font-weight: 500;">${error}</p>
                            <p style="margin-top: 12px; font-size: 14px; color: var(--md-outline);">
                                Either —Ç–∏–ø—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —è–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –±–µ–∑ throw/catch.
                            </p>
                        </div>
                        
                        <div class="code-block" style="margin-top: 16px;">
const result = validateSubmission(text, ${minLength});
// result.isLeft() === true
// result.getLeft() === "${error}"
                        </div>
                    </div>
                `;
            }
        }

        // ============ BENCHMARK (–õ–ê–ë–ê ‚Ññ3) ============
        async function runBenchmark() {
            const btn = event.target;
            btn.disabled = true;
            btn.innerHTML = '<div class="loading"></div> –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...';
            
            // –û—á–∏—â–∞–µ–º –∫—ç—à
            cache.clear();
            cacheStats = { hits: 0, misses: 0 };
            updateCacheStats();
            
            await new Promise(resolve => setTimeout(resolve, 100));
            
            // –¢–µ—Å—Ç –ë–ï–ó –∫—ç—à–∞
            const startNoCache = performance.now();
            const sampleSubs = appData.submissions.slice(0, 20);
            
            for (const sub of sampleSubs) {
                for (const doc of appData.documents.slice(0, 10)) {
                    const n1 = normalize(sub.text);
                    const n2 = normalize(doc.text);
                    const t1 = tokenize(n1);
                    const t2 = tokenize(n2);
                    const g1 = ngrams(t1, 3);
                    const g2 = ngrams(t2, 3);
                    jaccard(g1, g2);
                }
            }
            
            const timeNoCache = performance.now() - startNoCache;
            
            // –û—á–∏—â–∞–µ–º –∫—ç—à –¥–ª—è —á–µ—Å—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
            cache.clear();
            cacheStats = { hits: 0, misses: 0 };
            
            // –¢–µ—Å—Ç –° –∫—ç—à–µ–º (–ø–µ—Ä–≤—ã–π –ø—Ä–æ—Ö–æ–¥)
            const startCache1 = performance.now();
            for (const sub of sampleSubs) {
                for (const doc of appData.documents.slice(0, 10)) {
                    compareTextsCached(sub.text, doc.text, 3);
                }
            }
            const timeCache1 = performance.now() - startCache1;
            
            // –¢–µ—Å—Ç –° –∫—ç—à–µ–º (–≤—Ç–æ—Ä–æ–π –ø—Ä–æ—Ö–æ–¥ - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ)
            const startCache2 = performance.now();
            for (const sub of sampleSubs) {
                for (const doc of appData.documents.slice(0, 10)) {
                    compareTextsCached(sub.text, doc.text, 3);
                }
            }
            const timeCache2 = performance.now() - startCache2;
            
            const speedup1 = (timeNoCache / timeCache1).toFixed(2);
            const speedup2 = (timeNoCache / timeCache2).toFixed(2);
            
            btn.disabled = false;
            btn.innerHTML = '<span class="material-icons">speed</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–Ω—á–º–∞—Ä–∫';
            
            document.getElementById('benchmarkResult').innerHTML = `
                <div class="card" style="margin-top: 24px;">
                    <h3 class="card-title">
                        <span class="material-icons">analytics</span>
                        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–Ω—á–º–∞—Ä–∫–∞
                    </h3>
                    
                    <p style="margin-bottom: 20px; color: var(--md-outline);">
                        –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ: ${sampleSubs.length} –ø—Ä–æ–≤–µ—Ä–æ–∫ √ó ${appData.documents.slice(0, 10).length} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ = ${sampleSubs.length * 10} —Å—Ä–∞–≤–Ω–µ–Ω–∏–π
                    </p>
                    
                    <div class="stats-grid">
                        <div class="stat-item" style="background: #FFEBEE;">
                            <div class="stat-value" style="color: var(--md-error);">${timeNoCache.toFixed(0)}–º—Å</div>
                            <div class="stat-label">–ë–µ–∑ –∫—ç—à–∞</div>
                        </div>
                        <div class="stat-item" style="background: #FFF3E0;">
                            <div class="stat-value" style="color: var(--md-warning);">${timeCache1.toFixed(0)}–º—Å</div>
                            <div class="stat-label">–° –∫—ç—à–µ–º (1 –ø—Ä–æ—Ö–æ–¥)</div>
                        </div>
                        <div class="stat-item" style="background: #E8F5E9;">
                            <div class="stat-value" style="color: var(--md-success);">${timeCache2.toFixed(0)}–º—Å</div>
                            <div class="stat-label">–° –∫—ç—à–µ–º (2 –ø—Ä–æ—Ö–æ–¥)</div>
                        </div>
                    </div>
                    
                    <div class="info-box" style="margin-top: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
                        <h4 style="margin-bottom: 12px; font-size: 18px;">üöÄ –£—Å–∫–æ—Ä–µ–Ω–∏–µ:</h4>
                        <p style="font-size: 16px;">‚Ä¢ –ü–µ—Ä–≤—ã–π –ø—Ä–æ—Ö–æ–¥: –≤ <strong>${speedup1}x</strong> —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ</p>
                        <p style="font-size: 16px;">‚Ä¢ –í—Ç–æ—Ä–æ–π –ø—Ä–æ—Ö–æ–¥: –≤ <strong>${speedup2}x</strong> —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ</p>
                        <p style="margin-top: 12px; font-size: 14px; opacity: 0.9;">
                            –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è!
                        </p>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="benchmarkChart" width="400" height="200"></canvas>
                    </div>
                </div>
            `;
            
            // –†–∏—Å—É–µ–º –ø—Ä–æ—Å—Ç—É—é –¥–∏–∞–≥—Ä–∞–º–º—É
            drawBenchmarkChart(timeNoCache, timeCache1, timeCache2);
        }

        function drawBenchmarkChart(t1, t2, t3) {
            const canvas = document.getElementById('benchmarkChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const maxTime = Math.max(t1, t2, t3);
            const padding = 40;
            const barWidth = 80;
            const gap = 40;
            const maxHeight = canvas.height - 2 * padding;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // –†–∏—Å—É–µ–º —Å—Ç–æ–ª–±—Ü—ã
            const bars = [
                { x: padding, height: (t1 / maxTime) * maxHeight, color: '#BA1A1A', label: '–ë–µ–∑ –∫—ç—à–∞', time: t1 },
                { x: padding + barWidth + gap, height: (t2 / maxTime) * maxHeight, color: '#F57C00', label: '–° –∫—ç—à–µ–º (1)', time: t2 },
                { x: padding + 2 * (barWidth + gap), height: (t3 / maxTime) * maxHeight, color: '#2E7D32', label: '–° –∫—ç—à–µ–º (2)', time: t3 }
            ];
            
            bars.forEach(bar => {
                const y = canvas.height - padding - bar.height;
                
                // –°—Ç–æ–ª–±–µ—Ü
                ctx.fillStyle = bar.color;
                ctx.fillRect(bar.x, y, barWidth, bar.height);
                
                // –ó–Ω–∞—á–µ–Ω–∏–µ
                ctx.fillStyle = '#1C1B1F';
                ctx.font = 'bold 14px Roboto';
                ctx.textAlign = 'center';
                ctx.fillText(`${bar.time.toFixed(0)}–º—Å`, bar.x + barWidth / 2, y - 10);
                
                // –ü–æ–¥–ø–∏—Å—å
                ctx.font = '12px Roboto';
                ctx.fillText(bar.label, bar.x + barWidth / 2, canvas.height - padding + 20);
            });
        }

        // ============ REPORTS ============
        function generateReport() {
            generateSummaryReport();
            generateTopReport();
            generateUsersReport();
        }

        function generateSummaryReport() {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –≤—Å–µ—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö —Ä–∞–±–æ—Ç
            
            // –õ–ê–ë–ê ‚Ññ1: –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ + HOF (map/filter/reduce)
            const results = appData.submissions.map(sub => {
                // normalize, tokenize, ngrams, jaccard
                const similarities = appData.documents.map(doc => 
                    compareTextsCached(sub.text, doc.text, 3)
                );
                const maxSim = Math.max(...similarities);
                return { sub, maxSim };
            });
            
            // –õ–ê–ë–ê ‚Ññ2: –ó–∞–º—ã–∫–∞–Ω–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
            const byThreshold = (threshold) => (r) => r.maxSim >= threshold;
            
            const original = results.filter(r => r.maxSim < 0.3).length;
            const suspicious = results.filter(byThreshold(0.3)).filter(r => r.maxSim < 0.7).length;
            const plagiarism = results.filter(byThreshold(0.7)).length;
            
            // –õ–ê–ë–ê ‚Ññ1: reduce –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞
            const totalSimilarity = results.reduce((sum, r) => sum + r.maxSim, 0);
            const avgSimilarity = results.length > 0 ? (totalSimilarity / results.length) : 0;
            
            document.getElementById('summaryContent').innerHTML = `
                <div class="info-box" style="margin-bottom: 20px;">
                    <h4>üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:</h4>
                    <p>‚úÖ <strong>–õ–∞–±–∞ ‚Ññ1:</strong> map() –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏, filter() –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, reduce() –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏</p>
                    <p>‚úÖ <strong>–õ–∞–±–∞ ‚Ññ2:</strong> –ó–∞–º—ã–∫–∞–Ω–∏—è byThreshold() –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤</p>
                    <p>‚úÖ <strong>–õ–∞–±–∞ ‚Ññ3:</strong> –ú–µ–º–æ–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ compareTextsCached()</p>
                    <p>‚úÖ <strong>–°—Ä–µ–¥–Ω—è—è —Å—Ö–æ–∂–µ—Å—Ç—å:</strong> ${(avgSimilarity * 100).toFixed(1)}%</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-item" style="background: #E8F5E9;">
                        <div class="stat-value" style="color: var(--md-success);">${original}</div>
                        <div class="stat-label">‚úÖ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ (<30%)</div>
                    </div>
                    <div class="stat-item" style="background: #FFF3E0;">
                        <div class="stat-value" style="color: var(--md-warning);">${suspicious}</div>
                        <div class="stat-label">‚ö†Ô∏è –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ (30-70%)</div>
                    </div>
                    <div class="stat-item" style="background: #FFEBEE;">
                        <div class="stat-value" style="color: var(--md-error);">${plagiarism}</div>
                        <div class="stat-label">‚ùå –ü–ª–∞–≥–∏–∞—Ç (>70%)</div>
                    </div>
                </div>
                
                <div class="chart-container" style="margin-top: 20px;">
                    <canvas id="summaryChart" width="400" height="200"></canvas>
                </div>
                
                <div class="code-block" style="margin-top: 20px;">
// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è HOF –∏ –∑–∞–º—ã–∫–∞–Ω–∏–π:
const byThreshold = (threshold) => (result) => result.maxSim >= threshold;

const original = results.filter(r => r.maxSim < 0.3);
const suspicious = results.filter(byThreshold(0.3)).filter(r => r.maxSim < 0.7);
const plagiarism = results.filter(byThreshold(0.7));

const avgSimilarity = results.reduce((sum, r) => sum + r.maxSim, 0) / results.length;
                </div>
            `;
            
            setTimeout(() => drawPieChart(original, suspicious, plagiarism), 100);
        }

        function drawPieChart(original, suspicious, plagiarism) {
            const canvas = document.getElementById('summaryChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 80;
            
            const total = original + suspicious + plagiarism;
            if (total === 0) {
                ctx.font = '16px Roboto';
                ctx.fillStyle = '#666';
                ctx.textAlign = 'center';
                ctx.fillText('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è', centerX, centerY);
                return;
            }
            
            const colors = ['#2E7D32', '#F57C00', '#BA1A1A'];
            const values = [original, suspicious, plagiarism];
            const labels = ['–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ', '–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ', '–ü–ª–∞–≥–∏–∞—Ç'];
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            let currentAngle = -Math.PI / 2;
            
            values.forEach((value, i) => {
                if (value === 0) return;
                
                const sliceAngle = (value / total) * 2 * Math.PI;
                
                // –†–∏—Å—É–µ–º —Å–µ–∫—Ç–æ—Ä
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                ctx.closePath();
                ctx.fillStyle = colors[i];
                ctx.fill();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±–≤–æ–¥–∫—É
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // –†–∏—Å—É–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –≤ —Å–µ–∫—Ç–æ—Ä–µ
                const labelAngle = currentAngle + sliceAngle / 2;
                const labelX = centerX + Math.cos(labelAngle) * (radius * 0.6);
                const labelY = centerY + Math.sin(labelAngle) * (radius * 0.6);
                
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 14px Roboto';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                const percentage = Math.round((value / total) * 100);
                ctx.fillText(`${percentage}%`, labelX, labelY);
                
                currentAngle += sliceAngle;
            });
            
            // –†–∏—Å—É–µ–º –ª–µ–≥–µ–Ω–¥—É —Å–ø—Ä–∞–≤–∞
            const legendX = canvas.width - 150;
            let legendY = 20;
            
            values.forEach((value, i) => {
                if (value === 0) return;
                
                // –ö–≤–∞–¥—Ä–∞—Ç–∏–∫ —Ü–≤–µ—Ç–∞
                ctx.fillStyle = colors[i];
                ctx.fillRect(legendX, legendY, 20, 20);
                
                // –¢–µ–∫—Å—Ç
                ctx.fillStyle = '#1C1B1F';
                ctx.font = '14px Roboto';
                ctx.textAlign = 'left';
                ctx.textBaseline = 'top';
                ctx.fillText(`${labels[i]}: ${value}`, legendX + 28, legendY + 3);
                
                legendY += 30;
            });
        }

        function generateTopReport() {
            // –õ–ê–ë–ê ‚Ññ1: map –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
            const results = appData.submissions.map(sub => {
                // –õ–ê–ë–ê ‚Ññ1: normalize, tokenize, ngrams, jaccard
                const similarities = appData.documents.map(doc => ({
                    doc,
                    sim: compareTextsCached(sub.text, doc.text, 3)
                }));
                
                // –õ–ê–ë–ê ‚Ññ1: reduce –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–∞–∫—Å–∏–º—É–º–∞
                const best = similarities.reduce((max, current) => 
                    current.sim > max.sim ? current : max
                , similarities[0]);
                
                return { sub, ...best };
            }).sort((a, b) => b.sim - a.sim).slice(0, 10);
            
            // –õ–ê–ë–ê ‚Ññ2: –ó–∞–º—ã–∫–∞–Ω–∏–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞
            const getStatusClass = (percentage) => {
                if (percentage < 30) return 'status-success';
                if (percentage < 70) return 'status-warning';
                return 'status-error';
            };
            
            const html = results.map((r, i) => {
                const percentage = Math.round(r.sim * 100);
                const statusClass = getStatusClass(percentage);
                
                return `
                    <div class="doc-item">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-weight: 600;">${i + 1}. –ü—Ä–æ–≤–µ—Ä–∫–∞ ${r.sub.id}</span>
                            <span class="status-indicator ${statusClass}">${percentage}%</span>
                        </div>
                        <div class="doc-meta">
                            üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${r.sub.user_id} ‚Ä¢ 
                            üìÑ –ü–æ—Ö–æ–∂ –Ω–∞: "${r.doc.title}" (${r.doc.author})
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentage}%"></div>
                        </div>
                        <div class="doc-text">${r.sub.text.substring(0, 120)}...</div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('topContent').innerHTML = `
                <div class="info-box" style="margin-bottom: 20px; background: #E3F2FD; border-left-color: #2196F3;">
                    <h4>üîß –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏:</h4>
                    <p>‚Ä¢ <strong>map():</strong> –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è submissions –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</p>
                    <p>‚Ä¢ <strong>reduce():</strong> –ü–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ö–æ–∂–µ—Å—Ç—å—é</p>
                    <p>‚Ä¢ <strong>sort():</strong> –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—Ö–æ–∂–µ—Å—Ç–∏</p>
                    <p>‚Ä¢ <strong>–ó–∞–º—ã–∫–∞–Ω–∏–µ getStatusClass():</strong> –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥–∞–º</p>
                </div>
                
                <h3 style="margin-bottom: 16px;">üìâ –¢–æ–ø-10 –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫</h3>
                ${html}
                
                <div class="code-block" style="margin-top: 20px;">
// –ö–æ–º–ø–æ–∑–∏—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:
const results = submissions
    .map(sub => ({ sub, best: findBestMatch(sub, documents) }))
    .sort((a, b) => b.best.sim - a.best.sim)
    .slice(0, 10);

const getStatusClass = (percentage) => 
    percentage < 30 ? 'success' : percentage < 70 ? 'warning' : 'error';
                </div>
            `;
        }

        function generateUsersReport() {
            // –õ–ê–ë–ê ‚Ññ2: –ó–∞–º—ã–∫–∞–Ω–∏–µ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
            const groupByUser = (userId) => (sub) => sub.user_id === userId;
            
            // –õ–ê–ë–ê ‚Ññ1: map + filter + reduce
            const userStats = appData.users.map(user => {
                // –§–∏–ª—å—Ç—Ä—É–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const userSubs = appData.submissions.filter(groupByUser(user.id));
                
                if (userSubs.length === 0) {
                    return { user, count: 0, avgSim: 0, maxSim: 0 };
                }
                
                // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
                const similarities = userSubs.map(sub => {
                    const docSims = appData.documents.map(doc => 
                        compareTextsCached(sub.text, doc.text, 3)
                    );
                    return Math.max(...docSims);
                });
                
                // –õ–ê–ë–ê ‚Ññ1: reduce –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π
                const avgSim = similarities.reduce((sum, sim) => sum + sim, 0) / similarities.length;
                const maxSim = Math.max(...similarities);
                
                return { user, count: userSubs.length, avgSim, maxSim };
            })
            .filter(s => s.count > 0)  // –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
            .sort((a, b) => b.avgSim - a.avgSim);
            
            // –õ–ê–ë–ê ‚Ññ2: –ó–∞–º—ã–∫–∞–Ω–∏–µ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
            const classifyUser = (avgSimilarity) => {
                const percentage = avgSimilarity * 100;
                if (percentage < 30) return { class: 'status-success', icon: '‚úÖ', label: '–û—Ç–ª–∏—á–Ω–æ' };
                if (percentage < 50) return { class: 'status-warning', icon: '‚ö†Ô∏è', label: '–ù–æ—Ä–º–∞–ª—å–Ω–æ' };
                return { class: 'status-error', icon: '‚ùå', label: '–ü—Ä–æ–±–ª–µ–º—ã' };
            };
            
            const html = userStats.map((stat, i) => {
                const avgPercentage = Math.round(stat.avgSim * 100);
                const maxPercentage = Math.round(stat.maxSim * 100);
                const classification = classifyUser(stat.avgSim);
                
                return `
                    <div class="doc-item">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div class="doc-title">${i + 1}. ${stat.user.name}</div>
                                <div class="doc-meta">
                                    üìä –ü—Ä–æ–≤–µ—Ä–æ–∫: ${stat.count} ‚Ä¢ 
                                    üìà –°—Ä–µ–¥–Ω—è—è: ${avgPercentage}% ‚Ä¢ 
                                    üîù –ú–∞–∫—Å–∏–º—É–º: ${maxPercentage}%
                                </div>
                            </div>
                            <span class="status-indicator ${classification.class}">
                                ${classification.icon} ${classification.label}
                            </span>
                        </div>
                        <div class="progress-bar" style="margin-top: 12px;">
                            <div class="progress-fill" style="width: ${avgPercentage}%"></div>
                        </div>
                    </div>
                `;
            }).join('');
            
            // –õ–ê–ë–ê ‚Ññ1: reduce –¥–ª—è –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            const totalChecks = userStats.reduce((sum, s) => sum + s.count, 0);
            const avgOfAvgs = userStats.length > 0 
                ? userStats.reduce((sum, s) => sum + s.avgSim, 0) / userStats.length 
                : 0;
            
            document.getElementById('usersContent').innerHTML = `
                <div class="info-box" style="margin-bottom: 20px; background: #F3E5F5; border-left-color: #9C27B0;">
                    <h4>üéØ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –≤ –¥–µ–π—Å—Ç–≤–∏–∏:</h4>
                    <p>‚Ä¢ <strong>–ó–∞–º—ã–∫–∞–Ω–∏–µ groupByUser():</strong> –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é</p>
                    <p>‚Ä¢ <strong>map():</strong> –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</p>
                    <p>‚Ä¢ <strong>filter():</strong> –û—Ç—Å–µ–∏–≤–∞–Ω–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
                    <p>‚Ä¢ <strong>reduce():</strong> –ê–≥—Ä–µ–≥–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ (—Å—É–º–º–∞, —Å—Ä–µ–¥–Ω–µ–µ)</p>
                    <p>‚Ä¢ <strong>–ó–∞–º—ã–∫–∞–Ω–∏–µ classifyUser():</strong> –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥–∞–º</p>
                </div>
                
                <div class="stats-grid" style="margin-bottom: 20px;">
                    <div class="stat-item">
                        <div class="stat-value">${userStats.length}</div>
                        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${totalChecks}</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –ø—Ä–æ–≤–µ—Ä–æ–∫</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${Math.round(avgOfAvgs * 100)}%</div>
                        <div class="stat-label">–°—Ä–µ–¥–Ω—è—è —Å—Ö–æ–∂–µ—Å—Ç—å</div>
                    </div>
                </div>
                
                <h3 style="margin-bottom: 16px;">üë• –†–µ–π—Ç–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                ${html}
                
                <div class="code-block" style="margin-top: 20px;">
// –ö–æ–º–ø–æ–∑–∏—Ü–∏—è HOF –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
const groupByUser = (userId) => (sub) => sub.user_id === userId;

const userStats = users
    .map(user => ({
        user,
        subs: submissions.filter(groupByUser(user.id)),
        avgSim: calculateAverage(user),
        maxSim: calculateMax(user)
    }))
    .filter(stat => stat.subs.length > 0)
    .sort((a, b) => b.avgSim - a.avgSim);

const classifyUser = (avg) => 
    avg < 0.3 ? 'excellent' : avg < 0.5 ? 'good' : 'needs-attention';
                </div>
            `;
        }

        // ============ TESTS ============
        function runAllTests() {
            const btn = event.target;
            btn.disabled = true;
            btn.innerHTML = '<div class="loading"></div> –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–µ—Å—Ç—ã...';
            
            setTimeout(() => {
                const tests = [
                    testNormalize(),
                    testTokenize(),
                    testNgrams(),
                    testJaccard(),
                    testFilters(),
                    testMaybe(),
                    testEither(),
                    testCache()
                ];
                
                const passed = tests.filter(t => t.passed).length;
                const total = tests.length;
                
                const html = tests.map(test => `
                    <div class="doc-item" style="border-left-color: ${test.passed ? 'var(--md-success)' : 'var(--md-error)'}">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span class="doc-title">${test.name}</span>
                            <span class="status-indicator ${test.passed ? 'status-success' : 'status-error'}">
                                ${test.passed ? '‚úÖ –ü—Ä–æ–π–¥–µ–Ω' : '‚ùå –ü—Ä–æ–≤–∞–ª–µ–Ω'}
                            </span>
                        </div>
                        <p style="margin-top: 8px; color: var(--md-outline);">${test.description}</p>
                        ${test.error ? `<p style="margin-top: 8px; color: var(--md-error);">–û—à–∏–±–∫–∞: ${test.error}</p>` : ''}
                    </div>
                `).join('');
                
                btn.disabled = false;
                btn.innerHTML = '<span class="material-icons">play_circle</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã';
                
                document.getElementById('testResults').innerHTML = `
                    <div class="card" style="margin-top: 24px;">
                        <div class="info-box" style="background: ${passed === total ? '#E8F5E9' : '#FFF3E0'}; border-left-color: ${passed === total ? 'var(--md-success)' : 'var(--md-warning)'};">
                            <h3>${passed === total ? '‚úÖ' : '‚ö†Ô∏è'} –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                            <p style="font-size: 18px; margin-top: 12px;">
                                –ü—Ä–æ–π–¥–µ–Ω–æ: <strong>${passed} –∏–∑ ${total}</strong> —Ç–µ—Å—Ç–æ–≤
                            </p>
                        </div>
                        
                        ${html}
                    </div>
                `;
            }, 500);
        }

        function testNormalize() {
            try {
                const result = normalize("Hello, World!  ");
                return {
                    name: "test_normalize",
                    description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞",
                    passed: result === "hello world",
                    error: null
                };
            } catch (e) {
                return { name: "test_normalize", description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞", passed: false, error: e.message };
            }
        }

        function testTokenize() {
            try {
                const result = tokenize("a   b c");
                return {
                    name: "test_tokenize",
                    description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞",
                    passed: result.length === 3 && result[0] === "a",
                    error: null
                };
            } catch (e) {
                return { name: "test_tokenize", description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞", passed: false, error: e.message };
            }
        }

        function testNgrams() {
            try {
                const tokens = ["a", "b", "c", "d"];
                const result = ngrams(tokens, 3);
                return {
                    name: "test_ngrams",
                    description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è n-–≥—Ä–∞–º–º",
                    passed: result.length === 2 && result[0] === "a b c",
                    error: null
                };
            } catch (e) {
                return { name: "test_ngrams", description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è n-–≥—Ä–∞–º–º", passed: false, error: e.message };
            }
        }

        function testJaccard() {
            try {
                const a = ["a", "b", "c"];
                const b = ["b", "c", "d"];
                const result = jaccard(a, b);
                return {
                    name: "test_jaccard",
                    description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ñ–∞–∫–∫–∞—Ä–∞",
                    passed: result > 0 && result < 1,
                    error: null
                };
            } catch (e) {
                return { name: "test_jaccard", description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ñ–∞–∫–∫–∞—Ä–∞", passed: false, error: e.message };
            }
        }

        function testFilters() {
            try {
                const docs = appData.documents.slice(0, 5);
                const filter = byMinLength(100);
                const result = docs.filter(filter);
                return {
                    name: "test_filters",
                    description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–º—ã–∫–∞–Ω–∏–π-—Ñ–∏–ª—å—Ç—Ä–æ–≤",
                    passed: result.length >= 0,
                    error: null
                };
            } catch (e) {
                return { name: "test_filters", description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–º—ã–∫–∞–Ω–∏–π-—Ñ–∏–ª—å—Ç—Ä–æ–≤", passed: false, error: e.message };
            }
        }

        function testMaybe() {
            try {
                const just = Maybe.just(5);
                const nothing = Maybe.nothing();
                return {
                    name: "test_maybe",
                    description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ Maybe —Ç–∏–ø–∞",
                    passed: just.isJust() && nothing.isNothing() && just.get() === 5,
                    error: null
                };
            } catch (e) {
                return { name: "test_maybe", description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ Maybe —Ç–∏–ø–∞", passed: false, error: e.message };
            }
        }

        function testEither() {
            try {
                const right = Either.right(5);
                const left = Either.left("error");
                return {
                    name: "test_either",
                    description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ Either —Ç–∏–ø–∞",
                    passed: right.isRight() && left.isLeft() && right.getRight() === 5,
                    error: null
                };
            } catch (e) {
                return { name: "test_either", description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ Either —Ç–∏–ø–∞", passed: false, error: e.message };
            }
        }

        function testCache() {
            try {
                cache.clear();
                const text1 = "test text one";
                const text2 = "test text two";
                
                compareTextsCached(text1, text2, 3); // miss
                compareTextsCached(text1, text2, 3); // hit
                
                return {
                    name: "test_cache",
                    description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ–º–æ–∏–∑–∞—Ü–∏–∏",
                    passed: cacheStats.hits > 0 && cache.size > 0,
                    error: null
                };
            } catch (e) {
                return { name: "test_cache", description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ–º–æ–∏–∑–∞—Ü–∏–∏", passed: false, error: e.message };
            }
        }

        // ============ INITIALIZATION ============
        window.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>